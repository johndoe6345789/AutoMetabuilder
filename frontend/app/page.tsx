"use client";\n+\n+import { useEffect, useMemo, useState } from \"react\";\n+import DashboardSection from \"../components/sections/DashboardSection\";\n+import PromptSection from \"../components/sections/PromptSection\";\n+import SettingsSection from \"../components/sections/SettingsSection\";\n+import TranslationsSection from \"../components/sections/TranslationsSection\";\n+import WorkflowSection from \"../components/sections/WorkflowSection\";\n+import PageLayout from \"../components/layout/PageLayout\";\n+import {\n+  fetchContext,\n+  fetchWorkflowPackage,\n+  runBot,\n+  savePrompt,\n+  saveSettings,\n+  saveWorkflow,\n+} from \"../lib/api\";\n+import { UIContext } from \"../lib/types\";\n+\n+export default function HomePage() {\n+  const [context, setContext] = useState<UIContext | null>(null);\n+  const [selectedSection, setSelectedSection] = useState(\"dashboard\");\n+  const [loading, setLoading] = useState(true);\n+  const [error, setError] = useState(\"\");\n+\n+  const loadContext = async () => {\n+    setLoading(true);\n+    setError(\"\");\n+    try {\n+      const data = await fetchContext();\n+      setContext(data);\n+      setSelectedSection((prev) => prev || data.navigation[0]?.section || \"dashboard\");\n+    } catch (err) {\n+      setError(String(err));\n+    } finally {\n+      setLoading(false);\n+    }\n+  };\n+\n+  useEffect(() => {\n+    void loadContext();\n+  }, []);\n+\n+  const t = useMemo(\n+    () => (key: string, fallback?: string) => context?.messages[key] ?? fallback ?? key,\n+    [context]\n+  );\n+\n+  const handleRun = async (payload: Parameters<typeof runBot>[0]) => {\n+    await runBot(payload);\n+    await loadContext();\n+  };\n+\n+  const handleWorkflowSave = async (content: string) => {\n+    await saveWorkflow(content);\n+    await loadContext();\n+  };\n+\n+  const handleTemplateSelect = async (id: string) => {\n+    const pkg = await fetchWorkflowPackage(id);\n+    const workflowPayload = JSON.stringify(pkg.workflow ?? {}, null, 2);\n+    setContext((prev) => (prev ? { ...prev, workflow_content: workflowPayload } : prev));\n+  };\n+\n+  const handlePromptSave = async (content: string) => {\n+    await savePrompt(content);\n+    await loadContext();\n+  };\n+\n+  const handleSettingsSave = async (values: Record<string, string>) => {\n+    await saveSettings(values);\n+    await loadContext();\n+  };\n+\n+  if (loading) {\n+    return (\n+      <main className=\"app-loading\">\n+        <p>Loading dashboardâ€¦</p>\n+      </main>\n+    );\n+  }\n+\n+  if (error || !context) {\n+    return (\n+      <main className=\"app-loading\">\n+        <p>{error || \"Unable to load context.\"}</p>\n+        <button type=\"button\" onClick={loadContext}>\n+          Retry\n+        </button>\n+      </main>\n+    );\n+  }\n+\n+  return (\n+    <PageLayout\n+      navItems={context.navigation}\n+      section={selectedSection}\n+      onSectionChange={setSelectedSection}\n+      t={t}\n+    >\n+      {selectedSection === \"dashboard\" && (\n+        <DashboardSection logs={context.logs} status={context.status} onRun={handleRun} t={t} />\n+      )}\n+      {selectedSection === \"workflow\" && (\n+        <WorkflowSection\n+          content={context.workflow_content}\n+          packages={context.workflow_packages}\n+          onSave={handleWorkflowSave}\n+          onTemplateSelect={handleTemplateSelect}\n+          t={t}\n+        />\n+      )}\n+      {selectedSection === \"prompt\" && <PromptSection content={context.prompt_content} onSave={handlePromptSave} t={t} />}\n+      {selectedSection === \"settings\" && (\n+        <SettingsSection envVars={context.env_vars} onSave={handleSettingsSave} t={t} />\n+      )}\n+      {selectedSection === \"translations\" && (\n+        <TranslationsSection languages={context.translations} onRefresh={loadContext} t={t} />\n+      )}\n+    </PageLayout>\n+  );\n+}\n*** End Patch"""
